stale = 1
while stale:
    try:
        p = WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CLASS_NAME, 'preview-file')))
        stale = 1
    except exceptions.StaleElementReferenceException as e:
        stale = 0
p.click()


    text_list = driver.find_elements(By.TAG_NAME, "p")
    text = ""
    for block in text_list:
        text = text + block.text
    
    print(text.count("COVID"))



/////////////////////////////////////////
from xml.dom.minidom import Element
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.common import exceptions
from selenium.webdriver.common.action_chains import ActionChains
import time
from bs4 import BeautifulSoup
import requests

chrome_driver = 'C:\\Users\\aayur\\OneDrive\\Desktop\\Drivers\\chromedriver.exe'
driver = webdriver.Chrome(chrome_driver)

wait = WebDriverWait(driver, 5)
presence = EC.presence_of_element_located
visible = EC.visibility_of_element_located

driver.get('https://www.sec.gov/edgar/search/#/q=covid&filter_forms=10-Q')

searchbox = driver.find_element(by=By.ID, value=  'entity-short-form')
searchbox.send_keys('covid')
searchbox.send_keys(Keys.RETURN)

button = WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.ID, 'headingTwo2')))
button.click()

tenq = WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, '/html/body/div[3]/div[2]/div[1]/div[2]/div[2]/div[2]/div/table/tbody/tr[2]/td/a')))
tenq.click()
print("________________________")

time.sleep(1)

pages = WebDriverWait(driver, 10).until(
    EC.presence_of_all_elements_located((By.CLASS_NAME, "preview-file"))
)

i = 1
print("Length: " + str(len(pages)))

total_count = 0;
while i < len(pages):
    #click on each 10Q form
    pages[i].click();
    time.sleep(2)

    count = driver.find_element(By.CLASS_NAME, "find-counter").text
    count = count[5:len(count)]
    print(count)

    #click on the button to open the file
    button = driver.find_element(By.ID, "open-file")
    button.click()
    time.sleep(2)

    #switch driver to the new tab
    orig = driver.window_handles[0]
    window_name = driver.window_handles[1]
    driver.switch_to.window(window_name=window_name)

    time.sleep(1)

    #close the tab and switch driver to original tab
    driver.close()
    time.sleep(1)
    driver.switch_to.window(window_name=orig)
    time.sleep(1)

    #close the preview
    close = driver.find_element(By.CLASS_NAME, "close")
    close.click()

    i = i+1

    #html_text = requests.get(link).text
    #soup = BeautifulSoup(html_text, 'lxml')
    ///////////////////////////////////////////////////////////////////////////////////